<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib uri="http://www.springframework.org/tags/form" prefix="form"%>
<!DOCTYPE html>
<head>
<meta charset="UTF-8">
<title>student score list</title>
<style>
th {
	border: 1px solid black;
	text-align: center;
	background-color: rgb(41, 103, 68);
}

td {
	border: 1px solid;
	text-align: center;
	background-color: white;
	color: black;
}
#subTable th {
        text-align: center;
        position: sticky;
        top: 0px;
      }
</style>
</head>
<body>

	<!-- 이곳에는 학생의 개인 점수 조회..만 들어갈 것이다. -->
<!-- 페이지 타이틀 -->
<div class="page-titles">
   <ol class="breadcrumb">
      <li><h5 class="bc-title">전체학기 성적조회</h5></li>
      <li class="breadcrumb-item"><a href="javascript:void(0)">
         <svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M2.125 6.375L8.5 1.41667L14.875 6.375V14.1667C14.875 14.5424 14.7257 14.9027 14.4601 15.1684C14.1944 15.4341 13.8341 15.5833 13.4583 15.5833H3.54167C3.16594 15.5833 2.80561 15.4341 2.53993 15.1684C2.27426 14.9027 2.125 14.5424 2.125 14.1667V6.375Z" stroke="#2C2C2C" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M6.375 15.5833V8.5H10.625V15.5833" stroke="#2C2C2C" stroke-linecap="round" stroke-linejoin="round"/>
         </svg>
         성적 </a>
      </li>
      <li class="breadcrumb-item active"><a href="javascript:void(0)">전체학기 성적조회</a></li>
   </ol>
</div>
<div class="container-fluid">

   <!-- 표현하고자 하는 내용 넣기 -->

	<div class="card">
		<div class="card-body" style="width: 100%;">
			<div class="row mb-4" id="subInfo">
				<div style="margin-bottom: 1%;">
					<span style="font-size: large; color: #f96d00;">|</span>
					<span style="font-size: large; display: inline;">전체학기 성적 &nbsp;&nbsp;&nbsp;
						<select id="selectYear" name="openYear" class="form-control" style="width: 200px; display: inline;">
							<option selected>==해당연도/학기 선택==</option>
							<c:forEach items="${selectboxYearSeme}" var="scoreVO">
								<option value="${scoreVO.lecOpenYear}">${scoreVO.lecOpenYear}년${scoreVO.lecOpenSemester}학기</option>
							</c:forEach>
						</select>
					</span> &nbsp;
				</div>
		
				<div class="table-responsive" style="height: 40vh; overflow: auto;">
					<!-- table id="example3" -->
					<table id="subTable"
						class="table table-sm table-bordered table-hover">
						<thead>
							<tr class="table-active">
								<th>개설연도</th>
								<th>개설학기</th>
								<th>교과목명</th>
								<!-- <th>원점수</th> -->
								<!-- <th>등수</th> -->
								<th>등급</th>
								<th>이수학점</th>
								<th>비고</th>
							</tr>
						</thead>
						<tbody id="scoreTableBody">
							<c:forEach items="${sList}" var="studentScore">
								<c:set var="grade" value="${studentScore.grade}"/>
								<tr class="tblRow">
								<c:if test="${studentScore.lecOpenYear ne 2023 && studentScore.lecOpenSemester ne 1}">
									<td>${studentScore.lecOpenYear }</td>
									<td>${studentScore.lecOpenSemester }</td>
									<td>${studentScore.subName}</td>
									<%-- <td>${studentScore.oveScore}</td> --%>
									<%-- <td>${studentScore.rank}</td> --%>
<%-- 									<td>${studentScore.grade }</td> --%>
									<td>
										<c:choose>
							                <c:when test="${grade == 4.5}">A+</c:when>
							                <c:when test="${grade == 4.0}">A</c:when>
							                <c:when test="${grade == 3.5}">B+</c:when>
							                <c:when test="${grade == 3.0}">B</c:when>
							                <c:when test="${grade == 2.5}">C+</c:when>
							                <c:when test="${grade == 2.0}">C</c:when>
							                <c:when test="${grade == 1.5}">D</c:when>
						                	<c:otherwise>F</c:otherwise>
						            	</c:choose>
						            </td>
									<td>${studentScore.subCredit }</td>
									<td></td>
									</c:if>
								</tr>
							</c:forEach>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	
		<div class="card-body" style="width: 100%;">
			<div class="row mb-4" id="subInfo">
				<div style="margin-bottom: 1%;">
					<span style="font-size: large; color: #f96d00;">|</span><span
						style="font-size: large; display: inline;">교과이수 구분별 성적 &nbsp;&nbsp;&nbsp;
					</span> &nbsp;
				</div>
			
			
				<div class="table-responsive" style="height: 40vh; overflow: auto;">
					<table id="subTable" class="table table-sm table-bordered table-hover">
						<thead>
							<tr class="table-active">
								<th>개설연도</th>
								<th>개설학기</th>
								<th>교과구분</th>
								<th>이수구분</th>
								<th>총학점평균</th>
								<th>총이수학점</th>
							</tr>
						</thead>
						<tbody>
							<c:forEach items="${averageList}" var="averageScore">
								<tr class="tblRow">
									<td>${averageScore.lecOpenYear }</td>
									<td>${averageScore.lecOpenSemester }</td>
									<td>${averageScore.subSort}</td>
									<td>${averageScore.subType}</td>
									<td>${averageScore.gradeAverage }</td>
									<td>${averageScore.sumCredit }</td>
								</tr>
							</c:forEach>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
</div>	
	
<%-- <script>
// select 요소에서 연도와 학기를 선택할 때마다 이벤트 발생
document.getElementById("selectYear").addEventListener("change", function() {
  // 선택된 연도와 학기 정보 저장
  var selectedYear = this.value.split("-")[0];
  var selectedSemester = this.value.split("-")[1];

  // 학생 성적 테이블 업데이트
  var scoreTableBody = document.getElementById("scoreTableBody");
  scoreTableBody.innerHTML = "";

  sList: 서버에서 전달받은 학생 성적 정보
  <c:forEach items="${sList}" var="studentScore">
    해당 연도와 학기에 해당하는 학생 성적만 테이블에 출력
    <c:if test="${studentScore.lecOpenYear == selectedYear && studentScore.lecOpenSemester == selectedSemester}">
      var row = scoreTableBody.insertRow(-1);
      var lecOpenYearCell = row.insertCell(0);
      var lecOpenSemesterCell = row.insertCell(1);
      var subNameCell = row.insertCell(2);
      var gradeCell = row.insertCell(3);
      var subCreditCell = row.insertCell(4);
      var buttonCell = row.insertCell(5);

      lecOpenYearCell.innerHTML = studentScore.lecOpenYear;
      lecOpenSemesterCell.innerHTML = studentScore.lecOpenSemester;
      subNameCell.innerHTML = studentScore.subName;
      gradeCell.innerHTML = studentScore.grade;
      subCreditCell.innerHTML = studentScore.subCredit;
      buttonCell.innerHTML = "";
    </c:if>
  </c:forEach>
});
</script>
 --%>
<script>
	function filterTable() {
		var selectedYear = document.getElementById("selectYear").value;
		var tableBody = document.getElementById("scoreTableBody");
		var rows = tableBody.getElementsByTagName("tr");
		for (var i = 0; i < rows.length; i++) {
			var yearCell = rows[i].getElementsByTagName("td")[0];
			if (yearCell.innerHTML != selectedYear
					&& selectedYear != "==해당연도 선택==") {
				rows[i].style.display = "none";
			} else {
				rows[i].style.display = "";
			}
		}
	}
</script>