<%@ page language="java" contentType="text/html; charset=UTF-8" %>
<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>

<!-- 페이지 타이틀 -->
<c:if test="${cateCode eq 'n002' }">
	<div class="page-titles">
		<ol class="breadcrumb">
			<li><h5 class="bc-title">일반공지</h5></li>
			<li class="breadcrumb-item"><a href="javascript:void(0)">
				<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path d="M14.4065 14.8714H7.78821" stroke="#888888" stroke-linecap="round" stroke-linejoin="round"></path>
					<path d="M14.4065 11.0338H7.78821" stroke="#888888" stroke-linecap="round" stroke-linejoin="round"></path>
					<path d="M10.3137 7.2051H7.78827" stroke="#888888" stroke-linecap="round" stroke-linejoin="round"></path>
					<path fill-rule="evenodd" clip-rule="evenodd" d="M14.5829 2.52066C14.5829 2.52066 7.54563 2.52433 7.53463 2.52433C5.00463 2.53991 3.43805 4.20458 3.43805 6.74374V15.1734C3.43805 17.7254 5.01655 19.3965 7.56855 19.3965C7.56855 19.3965 14.6049 19.3937 14.6168 19.3937C17.1468 19.3782 18.7143 17.7126 18.7143 15.1734V6.74374C18.7143 4.19174 17.1349 2.52066 14.5829 2.52066Z" stroke="#888888" stroke-linecap="round" stroke-linejoin="round"></path>
				</svg>
				등록 </a>
			</li>
			<li class="breadcrumb-item active"><a href="#">일반공지</a></li>
		</ol>
		<a class="text-primary fs-13" data-bs-toggle="offcanvas" href="#offcanvasExample1" role="button" aria-controls="offcanvasExample1">+ Add Task</a>
	</div>
</c:if>
<c:if test="${cateCode eq 'n001' }">
	<div class="page-titles">
		<ol class="breadcrumb">
			<li><h5 class="bc-title">학사공지</h5></li>
			<li class="breadcrumb-item"><a href="javascript:void(0)">
				<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path d="M14.4065 14.8714H7.78821" stroke="#888888" stroke-linecap="round" stroke-linejoin="round"></path>
					<path d="M14.4065 11.0338H7.78821" stroke="#888888" stroke-linecap="round" stroke-linejoin="round"></path>
					<path d="M10.3137 7.2051H7.78827" stroke="#888888" stroke-linecap="round" stroke-linejoin="round"></path>
					<path fill-rule="evenodd" clip-rule="evenodd" d="M14.5829 2.52066C14.5829 2.52066 7.54563 2.52433 7.53463 2.52433C5.00463 2.53991 3.43805 4.20458 3.43805 6.74374V15.1734C3.43805 17.7254 5.01655 19.3965 7.56855 19.3965C7.56855 19.3965 14.6049 19.3937 14.6168 19.3937C17.1468 19.3782 18.7143 17.7126 18.7143 15.1734V6.74374C18.7143 4.19174 17.1349 2.52066 14.5829 2.52066Z" stroke="#888888" stroke-linecap="round" stroke-linejoin="round"></path>
				</svg>
				등록 </a>
			</li>
			<li class="breadcrumb-item active"><a href="#">학사공지</a></li>
		</ol>
		<a class="text-primary fs-13" data-bs-toggle="offcanvas" href="#offcanvasExample1" role="button" aria-controls="offcanvasExample1">+ Add Task</a>
	</div>
</c:if>
<c:if test="${cateCode eq 'r001' }">
	<div class="page-titles">
		<ol class="breadcrumb">
			<li><h5 class="bc-title">채용정보</h5></li>
			<li class="breadcrumb-item"><a href="javascript:void(0)">
				<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path d="M14.4065 14.8714H7.78821" stroke="#888888" stroke-linecap="round" stroke-linejoin="round"></path>
					<path d="M14.4065 11.0338H7.78821" stroke="#888888" stroke-linecap="round" stroke-linejoin="round"></path>
					<path d="M10.3137 7.2051H7.78827" stroke="#888888" stroke-linecap="round" stroke-linejoin="round"></path>
					<path fill-rule="evenodd" clip-rule="evenodd" d="M14.5829 2.52066C14.5829 2.52066 7.54563 2.52433 7.53463 2.52433C5.00463 2.53991 3.43805 4.20458 3.43805 6.74374V15.1734C3.43805 17.7254 5.01655 19.3965 7.56855 19.3965C7.56855 19.3965 14.6049 19.3937 14.6168 19.3937C17.1468 19.3782 18.7143 17.7126 18.7143 15.1734V6.74374C18.7143 4.19174 17.1349 2.52066 14.5829 2.52066Z" stroke="#888888" stroke-linecap="round" stroke-linejoin="round"></path>
				</svg>
				등록 </a>
			</li>
			<li class="breadcrumb-item active"><a href="#">채용정보</a></li>
		</ol>
		<a class="text-primary fs-13" data-bs-toggle="offcanvas" href="#offcanvasExample1" role="button" aria-controls="offcanvasExample1">+ Add Task</a>
	</div>
</c:if>


<!-- /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// -->

<div class="container-fluid">
	<div class="row">
		<div class="card">
		  <div class="card-header" style="padding-bottom:10px;">
            <div>
              <h4 id="cateName">
              	 <span style="font-size: 20px; color: #f96d00;">|&nbsp;</span> 게시글 등록
              </h4>
            </div>
          </div>
	      <div class="page-header min-height-300 border-0" style="background-image: url('https://images.unsplash.com/photo-1531512073830-ba890ca4eba2?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=1920&q=80');">
	        <span class="mask bg-gradient-secondary opacity-6"></span>
	      </div>
		<!-- <div class="card card-body mx-3 mx-md-4 mt-n6 m-0"> -->
	      <div class="card-body">
	        <form class="row gx-4 mb-2" id="insertForm" action="/board/admin/insert/${boardVO.cateCode}" method="post" enctype="multipart/form-data">
			  <div class="col-md-12">
				<div class="input-group input-group-outline mb-4 align-items-center">
				  제목 :&nbsp;&nbsp;<input type="text" class="form-control input-default " name="boTitle" placeholder="제목을 입력해주세요." id="boTitle">
				  <input type="hidden" name="userId" value="${sessionScope.userInfo.userId}">
				  <input type="hidden" name="cateCode"  id="cateCode" value="${boardVO.cateCode}">
				</div>
			  </div>
			  <div class="col-md-12">
			    <div class="mb-4" style="padding-left:3px;">
				  <textarea class="form-txtarea form-control" rows="20" id="boContent" name="boContent" style="width:100%;"></textarea>
			    </div>
			  </div>
			  <div class="col-md-12">
			    <div class="mb-1 ps-1">
	              <h6 class="mb-1">첨부파일</h6>
				  <div class="input-group input-group-outline">
				    <input type="file" class="form-control" multiple="multiple" name="boAttach">
				  </div>
	            </div>
				<div class="card-footer bg-white" style="border-color:#fff;">
					<ul class="mailbox-attachments d-flex align-items-stretch clearfix">
						<c:if test="${not empty board.boardAttachList }">
								<c:forEach items="${board.boardAttachList }" var="boAttach">
								<li><!-- 파일데이터를 출력하기위한 출력세트 -->
									<span class="mailbox-attachment-icon">
										<i class="far fa-file-pdf"></i>
									</span>
									<div class="mailbox-attachment-info">
										<a href="#" class="mailbox-attachment-name">
											<i class="fas fa-paperclip"></i>${boAttach.baOrigin }
										</a> 
										<span class="mailbox-attachment-size clearfix mt-1"> 
											<span>${boAttach.baFancysize } </span> 
												<span class="btn btn-default btn-sm float-right attachmentFileDel" id="span_${boAttach.baNo }">
													<i class="fas fa-times"></i>
												</span>
										</span>
									</div>
								</li>
								</c:forEach>
							</c:if>
						</ul>
					</div>
			  </div>
			  <div class="col-md-12 d-grid gap-3 d-md-flex justify-content-md-end">
			  <button type="button" class="btn btn-primary" id="insertBtn">등록</button>
<!-- 			    <button type="button" class="btn btn-danger" id="cancelBtn">취소</button> -->
			    <button type="button" class="btn btn-dark" id="listBtn">목록</button>
			  </div>
	        </form>
	       
	        </div>
      	</div>
     </div>
</div>      
      
      
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script src="/resources/vendor/global/global.min.js"></script>
	<script src="/resources/vendor/bootstrap-select/dist/js/bootstrap-select.min.js"></script>
	<script src="/resources/vendor/ckeditor/ckeditor.js"></script>
    <script src="/resources/js/custom.js"></script>
	<script src="/resources/js/deznav-init.js"></script>
    <script>
    
    $(function(){
    	CKEDITOR.replace("boContent",{
    		footnotesPrefix : 'a',
    		filebrowserUploadUrl:'${pageContext.request.contextPath }/imageUpload'
    	})
    	
    	var insertBtn = $("#insertBtn")
    	var cancelBtn = $("#cancelBtn")
    	var listBtn = $("#listBtn")
    	var insertForm = $("#insertForm")
    	var cateCode = $("#cateCode").val()
    	
   		listBtn.on("click", function () {
			location.href="/board/admin/list/"+cateCode;
		});
    	
    	
    	insertBtn.on("click",function(){
    		if($("#boTitle").val() == ""){
    			Swal.fire({
				  title: '제목 입력',
				  html: "게시글의 제목을 입력해 주세요.",
				  icon: 'warning'
				});
    			return false;
    		}
    		if(CKEDITOR.instances.boContent.getData() == ""){
    			Swal.fire({
  				  title: '내용 입력',
  				  html: "게시글의 내용을 입력해 주세요.",
  				  icon: 'warning'
  				});
    			return false;
    		}
			
    		Swal.fire({
  			  title: '게시글 등록',
  			  html : '게시글을 등록 하시겠습니까?',
  			  icon: 'question',
  			  showCancelButton: true,
  			  confirmButtonText: 'Yes'
  			}).then((result) => {
  			  if (result.isConfirmed) {
			  		Swal.fire(
   				      '등록 완료',
   				      '게시글이 등록되었습니다.',
   				      'success'
   				  	).then((result) => {
			    		insertForm.submit();
   				  	});
  			  } else {
  				  Swal.fire(
  				      '등록 중단',
  				      '게시글 등록이 중단되었습니다.',
  				      'error'
  				  )
  			  }
  			});
    	});
    	
	    $(".attachmentFileDel").on("click",function(){
			var id = $(this).prop("id");
			var idx = id.indexOf("_");
			var noticeFileNo = id.substring(idx + 1);
			var ptrn = "<input type='text' name='delNoticeNo' value='%V' hidden='hidden'/>";
			$("#noticeForm").append(ptrn.replace("%V",noticeFileNo));
			$(this).parents("li:first").hide();
		});
    	
    });
    
    
    </script>